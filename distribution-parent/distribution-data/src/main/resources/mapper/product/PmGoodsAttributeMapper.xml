<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chauncy.data.mapper.product.PmGoodsAttributeMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.chauncy.data.domain.po.product.PmGoodsAttributePo">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="sort" property="sort"/>
        <result column="update_time" property="updateTime"/>
        <result column="content" property="content"/>
        <result column="remark" property="remark"/>
        <result column="enabled" property="enabled"/>
        <result column="type" property="type"/>
        <result column="subtitle" property="subtitle"/>
        <result column="logo_image" property="logoImage"/>
        <result column="logo_icon" property="logoIcon"/>
        <result column="create_by" property="createBy"/>
        <result column="create_time" property="createTime"/>
        <result column="update_by" property="updateBy"/>
        <result column="update_time" property="updateTime"/>
        <result column="del_flag" property="delFlag"/>
    </resultMap>

    <sql id="find">

    </sql>

    <select id="findByTypeAndName" resultType="com.chauncy.data.domain.po.product.PmGoodsAttributePo">
        select * from pm_goods_attribute
        <where>
            <if test="type != null and type !=''">
                and type = #{type}
            </if>
            <if test="name != null and name !=''">
                and name like concat('%', #{name}, '%')
            </if>
            and del_flag = 0
        </where>

    </select>

    <select id="findByCondition" resultType="com.chauncy.data.vo.manage.product.PmGoodsAttributeVo">
        select * from pm_goods_attribute
        <where>
            <if test="type !=null and type !=''">
                type = #{type}
            </if>
            <if test="name != null and name !=''">
                and name like concat('%', #{name}, '%')
            </if>
            <if test="enabled != null">
                and enabled = #{enabled}
            </if>
            and del_flag = 0
        </where>
        order by id desc
    </select>


    <select id="loadByCategoryId" resultType="com.chauncy.data.domain.po.product.PmGoodsAttributePo">
       SELECT ag.* FROM `pm_goods` g,pm_goods_rel_attribute_good ag
       where g.goods_category_id=#{categoryId} and g.id=ag.goods_good_id
    </select>

    <select id="findAttByTypeAndCat" resultType="com.chauncy.data.vo.BaseVo">
        SELECT b.id,b.name
        FROM pm_goods_rel_attribute_category a, pm_goods_attribute b
        where b.type=#{type} and a.goods_category_id= #{categoryId} and a.goods_attribute_id = b.id and b.enabled = 1
    </select>

    <!--<resultMap value="GoodsStandardVo" type="com.chauncy.data.vo.supplier.GoodsStandardVo   <result column="value_name" property="valueName"/>
        <result column="value" property="value" javaType="java.util.List" jdbcType="VARCHAR" typeHandler="com.chauncy.web.config.mybatisplus.StringToListTypeHandler"/>
    </resultMap>-->

    <select id="findStandardName" resultType="com.chauncy.data.bo.base.BaseBo">
        select b.id,b.name
        from pm_goods_rel_attribute_category a ,pm_goods_attribute b
        where a.goods_category_id = #{categoryId} and a.goods_attribute_id = b.id and b.type =7 and b.enabled = 1 and a.del_flag = 0
        GROUP BY b.id,b.name
    </select>
    <select id="loadAttributeIdNameTypeVos"
            resultType="com.chauncy.data.vo.manage.product.AttributeIdNameTypeVo">
        select id,name,type
        from pm_goods_attribute
        where del_flag=0 AND enabled=1
        and type  in
        <foreach collection="types" item="type" separator="," open="(" close=")">
                  #{type}
        </foreach>

    </select>
    <select id="findAttByType" resultType="com.chauncy.data.vo.BaseVo">
        select *
        from pm_goods_attribute
        where type = #{type}
    </select>


</mapper>
