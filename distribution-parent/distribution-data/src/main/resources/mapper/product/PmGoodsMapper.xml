<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chauncy.data.mapper.product.PmGoodsMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.chauncy.data.domain.po.product.PmGoodsPo">
        <id column="id" property="id"/>
        <result column="goods_category_id" property="goodsCategoryId"/>
        <result column="name" property="name"/>
        <result column="subtitle" property="subtitle"/>
        <result column="icon" property="icon"/>
        <result column="carousel_image" property="carouselImage"/>
        <result column="detail_html" property="detailHtml"/>
        <result column="shipping_template_id" property="shippingTemplateId"/>
        <result column="location" property="location"/>
        <result column="purchase_limit" property="purchaseLimit"/>
        <result column="member_id" property="memberId"/>
        <result column="is_tax" property="isTax"/>
        <result column="activity_cost_rate" property="activityCostRate"/>
        <result column="profits_rate" property="profitsRate"/>
        <result column="generalize_cost_rate" property="generalizeCostRate"/>
        <result column="tax_rate_type" property="taxRateType"/>
        <result column="custom_tax_rate" property="customTaxRate"/>
        <result column="sort" property="sort"/>
        <result column="stock" property="stock"/>
        <result column="low_stock" property="lowStock"/>
        <result column="publish_status" property="publishStatus"/>
        <result column="new_status" property="newStatus"/>
        <result column="recommand_status" property="recommandStatus"/>
        <result column="star_status" property="starStatus"/>
        <result column="verify_status" property="verifyStatus"/>
        <result column="store_id" property="storeId"/>
        <result column="goods_type" property="goodsType"/>
        <result column="spu" property="spu"/>
        <result column="create_by" property="createBy"/>
        <result column="create_time" property="createTime"/>
        <result column="update_by" property="updateBy"/>
        <result column="update_time" property="updateTime"/>
        <result column="del_flag" property="delFlag"/>
    </resultMap>

    <resultMap id="PmGoodsAttributeValueVo" type="com.chauncy.data.vo.supplier.PmGoodsAttributeValueVo">
        <result column="name" property="name"/>
        <result column="value" property="value" javaType="java.util.List" jdbcType="VARCHAR" typeHandler="com.chauncy.web.config.mybatisplus.StringToListTypeHandler"/>
    </resultMap>

    <select id="searchStandard" resultMap="PmGoodsAttributeValueVo">
        select b.name,GROUP_CONCAT(c.value) as value
        from pm_goods_rel_attribute_category a ,pm_goods_attribute b ,pm_goods_attribute_value c
        where a.goods_category_id = #{categoryId} and a.goods_attribute_id = b.id and b.id = c.product_attribute_id and b.type =7 and c.is_custom = 0
        GROUP BY b.name
    </select>

</mapper>
