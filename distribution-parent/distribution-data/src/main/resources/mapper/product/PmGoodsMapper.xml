<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chauncy.data.mapper.product.PmGoodsMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.chauncy.data.domain.po.product.PmGoodsPo">
        <id column="id" property="id"/>
        <result column="goods_category_id" property="goodsCategoryId"/>
        <result column="name" property="name"/>
        <result column="subtitle" property="subtitle"/>
        <result column="icon" property="icon"/>
        <result column="carousel_image" property="carouselImage"/>
        <result column="detail_html" property="detailHtml"/>
        <result column="shipping_template_id" property="shippingTemplateId"/>
        <result column="location" property="location"/>
        <result column="purchase_limit" property="purchaseLimit"/>
        <result column="is_tax" property="isTax"/>
        <result column="activity_cost_rate" property="activityCostRate"/>
        <result column="profits_rate" property="profitsRate"/>
        <result column="generalize_cost_rate" property="generalizeCostRate"/>
        <result column="tax_rate_type" property="taxRateType"/>
        <result column="custom_tax_rate" property="customTaxRate"/>
        <result column="sort" property="sort"/>
        <result column="is_free_postage" property="isFreePostage"/>
        <result column="stock" property="stock"/>
        <result column="low_stock" property="lowStock"/>
        <result column="publish_status" property="publishStatus"/>
        <result column="new_status" property="newStatus"/>
        <result column="recommand_status" property="recommandStatus"/>
        <result column="star_status" property="starStatus"/>
        <result column="verify_status" property="verifyStatus"/>
        <result column="store_id" property="storeId"/>
        <result column="goods_type" property="goodsType"/>
        <result column="spu" property="spu"/>
        <result column="create_by" property="createBy"/>
        <result column="create_time" property="createTime"/>
        <result column="update_by" property="updateBy"/>
        <result column="update_time" property="updateTime"/>
        <result column="del_flag" property="delFlag"/>
        <result column="content" property="content"/>
        <result column="is_excel" property="isExcel"/>
    </resultMap>

    <update id="updateStock">
        update pm_goods set stock=stock+#{number} where id=#{goodId}
    </update>

    <select id="findGoodsValue" resultType="com.chauncy.data.bo.supplier.good.GoodsValueBo">
        select b.id,b.value as name,b.is_custom
        from pm_goods_rel_attribute_value_good a ,pm_goods_attribute_value b, pm_goods_attribute c
        <where>
            a.goods_attribute_value_id = b.id and b.product_attribute_id = c.id and a.del_flag = 0
            <if test="attributeId !=null">
                and c.id = #{attributeId}
            </if>
            <if test="goodsId !=null">
                and a.goods_id=#{goodsId}
            </if>
        </where>

    </select>

    <select id="searchGoodsInfo" resultType="com.chauncy.data.vo.supplier.PmGoodsVo">

    </select>


</mapper>
